package com.rubu.util;

import android.content.Context;
import android.content.SharedPreferences;

import com.google.gson.Gson;
import com.rubu.model.UserModel;

/**
 * 类描述：
 * 创建人：admin
 * 创建时间：2016/5/10 16:14
 * 修改人：admin
 * 修改时间：2016/5/10 16:14
 * 修改备注：
 */
public class LoginUtil {

    private static String SP_NAME = "shangjia";
    private static String KEY = "shangjia";
    public static UserModel info;

    public static String getUserId(Context context) {
        if (info == null) {
            info = getInfo(context);
        }
        if (info == null) {
            return "";
        } else {
            return String.valueOf(info.getS_user_id());
        }
    }

    public static String getUserName(Context context) {
        if (info == null) {
            info = getInfo(context);
        }
        if (info == null) {
            return "";
        } else {
            return String.valueOf(info.getS_user_name());
        }
    }

    public static String getTel(Context context) {
        if (info == null) {
            info = getInfo(context);
        }
        if (info == null) {
            return "";
        } else {
            return String.valueOf(info.getS_bind_tel());
        }
    }

    public static String getIsRemainder(Context context) {
        if (info == null) {
            info = getInfo(context);
        }
        if (info == null) {
            return "N";
        } else {
            return String.valueOf(info.getIs_remind());
        }
    }

    public static void clearInfo() {
        info = null;
    }

    /**
     * 保存登录信息
     *
     * @param mContext
     * @param info
     */
    public static void saveInfo(Context mContext, UserModel info) {
        Gson gson = new Gson();
        String gsonInfo = gson.toJson(info);
        gsonInfo = AESUtils.encode(gsonInfo);
        savaUser(mContext, gsonInfo);
    }

    /**
     * 获取登录信息
     *
     * @param mContext
     */
    public static UserModel getInfo(Context mContext) {
        Gson gson = new Gson();
        String gsonInfo = getInfoStr(mContext);
        if (StringUtil.isEmpty(gsonInfo)) return null;
        return gson.fromJson(gsonInfo, UserModel.class);
    }

    /**
     * 是否登录
     *
     * @param context context
     * @return 是否登录
     */
    public static boolean isLogin(Context context) {
        return null != getInfo(context);
    }

    /**
     * 清空登录信息
     *
     * @param mContext
     */
    public static void clearInfo(Context mContext) {
        SharedPreferences sp = mContext.getApplicationContext().getSharedPreferences(SP_NAME, Context.MODE_PRIVATE);
        sp.edit().clear().apply();
    }

    private static void savaUser(Context mContext, String info) {
        SharedPreferences sp = mContext.getApplicationContext().getSharedPreferences(SP_NAME, Context.MODE_PRIVATE);
        try {
            sp.edit().putString(KEY, info).apply();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private static String getInfoStr(Context mContext) {
        SharedPreferences sp = mContext.getApplicationContext().getSharedPreferences(SP_NAME, Context.MODE_PRIVATE);
        String info = sp.getString(KEY, "");
        if (!StringUtil.isEmpty(info)) {
            try {
                return AESUtils.decode(info);
            } catch (Exception e) {
                return "";
            }
        }
        return "";
    }

}
